---
layout:     post
title:      Rustc Arch Zero
subtitle:   å¦‚ä½•æ‹†è§£ã€Œ èƒèŸ¹ğŸ¦€ ã€?
date:       2021-04-14
author:     Matrixtang
header-img: img/2021-07-01-RustcArchZero.png 

catalog: true
tags:
    - Compilation principle
    - rust
    
---



# Rustc Arch - 0

è½¬çœ¼å·²ç»åœ¨ Rustc çš„å®˜æ–¹ Zuilp ç¾¤, å¾…äº†å¿«ä¸‰ä¸ªæœˆäº†ã€‚ä¹‹å‰å‘ Rustc æäº¤çš„ pr å±…ç„¶ä¸€ç›´æ²¡è¿‡, åæ¥æ‰çŸ¥é“è¢«åˆ«äººæ”¹æ‰äº†ã€‚å€’æ˜¯, åœ¨å…¶ä»–çš„åœ°æ–¹( æ¯”å¦‚ rust-lang/this-week-in-rust å’Œ Clippy ä¸Šå¸®å¿™ reviewäº†ä»£ç )ä¹Ÿç®—æ˜¯åšå‡ºäº†å¾®å°çš„è´¡çŒ®å§ã€‚ä¸è¿‡, Rust ç¤¾åŒºè¿˜æ˜¯å¾ˆå‹å¥½çš„, ä¼šå¸®åŠ©å…¶ä»–æ„¿æ„å¼€å‘çš„å¿—æ„¿è€…, ç»™åˆå­¦è€…åˆ†é… mentor (å¯æ˜¯ æˆ‘ä¸€ç›´æ²¡è¢«åˆ†åˆ°)ã€‚æˆ‘è‡ªå·±ä¹Ÿçœ‹äº†å‡ ç« å®˜æ–¹çš„å¼€å‘æ‰‹å†Œ, ç®—æ˜¯æœ‰ä¸€äº›ç»éªŒå§ã€‚ä¸‹é¢æˆ‘ä¼šä»‹ç»ä¸€ä¸‹ rustc çš„ Working groups, å¹¶ä¸”ç®€å•æ€»ç»“ä¸€ä¸‹ rustc çš„æ•´ä½“æ¶æ„, å¸Œæœ›èƒ½ç»™å…¶ä»–æ„Ÿå…´è¶£çš„äººåšä¸€ä¸ªå‚è€ƒã€‚



## Working groups

[link](https://rust-lang.github.io/compiler-team/)

----



### Intro

ç¼–è¯‘å™¨å›¢é˜Ÿæ­£åœ¨è¿›è¡Œçš„å¤§éƒ¨åˆ†å·¥ä½œå’Œè®¡åˆ’éƒ½æ˜¯ç”±å·¥ä½œç»„ (Work)æ‰§è¡Œçš„ã€‚ä¸ºæ–°åŠ å…¥çš„è´¡çŒ®è€…åˆ†é…ä»»åŠ¡, æ‰€æœ‰ä»»åŠ¡éƒ½é›†ä¸­åœ¨ä¸€ä¸ªé¢†åŸŸï¼Œå¹¶æœ‰æŒ‡å®šçš„ metor ã€‚



è¯¦ç»†çš„è¡¨æ ¼åœ¨è¿™é‡Œ



| Name                                                         | Status     | Short Description                                            | Zulip Stream                                                 |
| ------------------------------------------------------------ | ---------- | ------------------------------------------------------------ | ------------------------------------------------------------ |
| [Async-await Implementation](https://rust-lang.github.io/compiler-team/working-groups/async-await/) | Active     | Implementing async-await                                     | [#t-compiler/wg-async-await](https://rust-lang.zulipchat.com/#narrow/stream/187312-t-compiler.2Fwg-async-await) |
| [Diagnostics](https://rust-lang.github.io/compiler-team/working-groups/diagnostics/) | Active     | Use crates.io crates for diagnostics rendering and make emitting diagnostics nicer. | [#t-compiler/wg-diagnostics](https://rust-lang.zulipchat.com/#narrow/stream/147480-t-compiler.2Fwg-diagnostics) |
| [Rustc Dev Guide](https://rust-lang.github.io/compiler-team/working-groups/rustc-dev-guide/) | Active     | Make the compiler easier to learn by ensuring that rustc-dev-guide is â€œcompleteâ€ | [#t-compiler/wg-rustc-dev-guide](https://rust-lang.zulipchat.com/#narrow/stream/196385-t-compiler.2Fwg-rustc-dev-guide) |
| [LLVM](https://rust-lang.github.io/compiler-team/working-groups/llvm/) | Incubating | Working with LLVM upstream to represent Rust in its development | [#t-compiler/wg-llvm](https://rust-lang.zulipchat.com/#narrow/stream/187780-t-compiler.2Fwg-llvm) |
| [Meta](https://rust-lang.github.io/compiler-team/working-groups/meta/) | Paused     | How compiler team organizes itself                           | [#t-compiler/wg-meta](https://rust-lang.zulipchat.com/#narrow/stream/185694-t-compiler.2Fwg-meta) |
| [MIR Optimizations](https://rust-lang.github.io/compiler-team/working-groups/mir-opt/) | Active     | Write MIR optimizations and refactor the MIR to be more optimizable. | [#t-compiler/wg-mir-opt](https://rust-lang.zulipchat.com/#narrow/stream/189540-t-compiler.2Fwg-mir-opt) |
| [Non-Lexical Lifetimes (NLL)](https://rust-lang.github.io/compiler-team/working-groups/nll/) | Retired    | Implementing non-lexical lifetimes                           | [#t-compiler/wg-nll](https://rust-lang.zulipchat.com/#narrow/stream/122657-t-compiler.2Fwg-nll) |
| [Parallel-rustc](https://rust-lang.github.io/compiler-team/working-groups/parallel-rustc/) | Paused     | Making parallel compilation the default for rustc            | [#t-compiler/wg-parallel-rustc](https://rust-lang.zulipchat.com/#narrow/stream/187679-t-compiler.2Fwg-parallel-rustc) |
| [Polonius](https://rust-lang.github.io/compiler-team/working-groups/polonius/) | Active     | Exploring the integration of the â€œNLL 2.0â€-like [â€œPolonius analysisâ€](https://github.com/rust-lang/polonius) into rustc | [#t-compiler/wg-polonius](https://rust-lang.zulipchat.com/#narrow/stream/186049-t-compiler.2Fwg-polonius) |
| [Polymorphization](https://rust-lang.github.io/compiler-team/working-groups/polymorphization/) | Active     | Implement an analysis to detect when functions can remain polymorphic during code generation. | [#t-compiler/wg-polymorphization](https://rust-lang.zulipchat.com/#narrow/stream/216091-t-compiler.2Fwg-polymorphization) |
| [Prioritization](https://rust-lang.github.io/compiler-team/working-groups/prioritization/) | Active     | Triaging bugs, mainly deciding if bugs are critical (potential release blockers) or not. | [#t-compiler/wg-prioritization](https://rust-lang.zulipchat.com/#narrow/stream/227806-t-compiler.2Fwg-prioritization) |
| [Profile-Guided Optimization](https://rust-lang.github.io/compiler-team/working-groups/pgo/) | Retired    | Implementing profile-guided optimization for rustc           | [#t-compiler/wg-profile-guided-optimization](https://rust-lang.zulipchat.com/#narrow/stream/187830-t-compiler.2Fwg-profile-guided-optimization) |
| [RFC 2229](https://rust-lang.github.io/compiler-team/working-groups/rfc-2229/) | Active     | Make a closure capture individual fields of the variable rather than the entire composite variable | [#t-compiler/wg-rfc-2229](https://rust-lang.zulipchat.com/#narrow/stream/189812-t-compiler.2Fwg-rfc-2229) |
| [RLS 2.0](https://rust-lang.github.io/compiler-team/working-groups/rls-2.0/) | Active     | Experimenting with a new compiler architecture tailored for IDEs | [#t-compiler/wg-rls2.0](https://rust-lang.zulipchat.com/#narrow/stream/185405-t-compiler.2Fwg-rls-2.2E0) |
| [Rustc pipelining](https://rust-lang.github.io/compiler-team/working-groups/pipelining/) | Retired    | Enable Cargo to invoke rustc in a pipelined fashion, speeding up crate graph compiles. | [#t-compiler/wg-pipelining](https://rust-lang.zulipchat.com/#narrow/stream/195180-t-compiler.2Fwg-pipelining) |
| [Self-Profile](https://rust-lang.github.io/compiler-team/working-groups/self-profile/) | Active     | Improving the `-Z self-profile` feature                      | [#t-compiler/wg-self-profile](https://rust-lang.zulipchat.com/#narrow/stream/187831-t-compiler.2Fwg-self-profile) |
| [Traits](https://rust-lang.github.io/compiler-team/working-groups/traits/) | Active     | Improving the trait-system design + implementation           | [#t-compiler/wg-traits](https://rust-lang.zulipchat.com/#narrow/stream/144729-t-compiler.2Fwg-traits) |

ps ç°åœ¨ RLS é‡æ„äº† å’Œ RA æœ‰ç«äº‰å…³ç³». æˆ‘ä¹Ÿçœ‹äº† RA çš„æ•´ä½“æ¶æ„, ä¹‹åä¼šæ€»ç»“ä¸€ç¯‡æ–‡ç« ã€‚

æˆ‘ç°åœ¨ç®—æ˜¯ [Diagnostics](https://rust-lang.github.io/compiler-team/working-groups/diagnostics/)çš„æˆå‘˜, ä¸»è¦è¿˜æ˜¯å¸®åŠ©å®Œæˆæµ‹è¯•æ ·ä¾‹ ,ä»¥åŠå®Œæˆæ›´å¥½çš„æŠ¥é”™ä¿¡æ¯ã€‚



###  How can I get involved?

é‚£ä¹ˆå¦‚ä½•åŠ å…¥è¿™ä¸ª workgroups å‘¢? 

å…¶å®å¾ˆç®€å•, ä½ åªéœ€è¦ä¸‹è½½ä¸€ä¸ª Zuilp å°±å¥½äº†ã€‚ä¹‹ååŠ å…¥ä»–ä»¬çš„ç¾¤ç»„, æ‰¾åˆ°ä½ å–œæ¬¢çš„ç»„, ç„¶åè‡ªæˆ‘ä»‹ç»ä¸€ä¸‹ã€‚ä¼šæœ‰äººç»™ä½ åˆ†æ´¾ä»»åŠ¡, ä½ ä¹Ÿå¯ä»¥è‡ªå·±é€›ä¸€ä¸‹ Rust çš„å…¶ä»–ä»“åº“,æ‰¾åˆ°æœ‰ Help_wantedå­—æ ·çš„ issue , è¯´æ˜è‡ªå·±æƒ³å‚ä¸å¼€å‘å°±å¯ä»¥äº†ã€‚

å°±ç®—æ˜¯æ²¡æ—¶é—´å‚ä¸ / æäº¤çš„ä»£ç æ²¡æœ‰è¢«é‡‡çº³, ä¹Ÿå¯ä»¥è·Ÿè¿›ä»–ä»¬çš„ä¼šè®® , å’Œå¤§å®¶ä¸€èµ·è®¨è®ºé—®é¢˜, ä¸€èµ·è¿›è¡Œ issue çš„å•†è®¨ã€‚

æƒ³æ›´æ·±å…¥çš„ç†è§£ rustc å¹¶ä¸”å‚ä¸åˆ° rust çš„å¼€å‘ä¸­æ¥çš„è¯, å»ºè®®é˜…è¯»ä¸€ä¸‹ å®˜æ–¹çš„ rustc-dev-guideã€‚



## Rustc çš„æ¶æ„ (éå¸¸ç²—ç•¥)

![rust-complie-process.png](https://cdn.nlark.com/yuque/0/2021/png/114846/1612083124731-06b6bed9-304b-4001-8461-826b2df6400e.png?x-oss-process=image%2Fresize%2Cw_1504)

æ¥æº: rust_magazine_2021

rustçš„ç¼–è¯‘å™¨åœ¨ä¸¤æ–¹é¢ç‹¬å…·ç‰¹è‰²ï¼šé¦–å…ˆå®ƒä¼šå¯¹ä½ çš„ä»£ç è¿›è¡Œåˆ«çš„ç¼–è¯‘å™¨ä¸ä¼šè¿›è¡Œçš„æ“ä½œï¼ˆæ¯”å¦‚å€Ÿç”¨æ£€æŸ¥ï¼‰ï¼Œå¹¶ä¸”æœ‰è®¸å¤šéå¸¸è§„çš„å®ç°é€‰æ‹©ï¼ˆæ¯”å¦‚æŸ¥è¯¢ï¼‰ã€‚ 

###  Rustc ç¼–è¯‘æµç¨‹

- ç¼–è¯‘æ­¥éª¤ä»ç”¨æˆ·ç¼–å†™ Rust ç¨‹åºæ–‡æœ¬å¹¶ä¸”ä½¿ç”¨ `rustc` ç¼–è¯‘å™¨å¯¹å…¶è¿›è¡Œå¤„ç†å¼€å§‹ã€‚å‘½ä»¤è¡Œå‚æ•°æŒ‡æ˜äº†ç¼–è¯‘å™¨éœ€è¦åšçš„å·¥ä½œã€‚ ä¸¾ä¸ªä¾‹å­ï¼Œæˆ‘ä»¬å¯ä»¥å¯ç”¨å¼€å‘ç‰ˆç‰¹æ€§ï¼ˆ`-Z` æ ‡è¯†ï¼‰ï¼Œæ‰§è¡Œ `check`â€”â€”ä»…æ‰§è¡Œæ„å»ºï¼Œæˆ–è€…å¾—åˆ° LLVM-IR è€Œä¸æ˜¯å¯æ‰§è¡Œæœºå™¨ç ã€‚ é€šè¿‡ä½¿ç”¨ `cargo`ï¼Œ`rustc` çš„æ‰§è¡Œå¯èƒ½æ˜¯ä¸ç›´æ¥çš„ã€‚

- å‘½ä»¤è¡Œå‚æ•°è§£æåœ¨ [`rustc_driver`](https://rustc-dev-guide.rust-lang.org/rustc-driver.html) ä¸­å‘ç”Ÿã€‚è¿™ä¸ª crate å®šä¹‰äº†ç”¨æˆ·è¯·æ±‚çš„ç¼–è¯‘é…ç½® å¹¶ä¸”å°†å…¶ä½œä¸ºä¸€ä¸ª [`rustc_interface::Config`](https://doc.rust-lang.org/nightly/nightly-rustc/rustc_interface/interface/struct.Config.html) ä¼ ç»™æ¥ä¸‹æ¥çš„ç¼–è¯‘è¿‡ç¨‹ã€‚

  ```rust
  fn arg_expand(arg: String) -> Result<Vec<String>, Error> {
      if let Some(path) = arg.strip_prefix('@') {
          let file = match fs::read_to_string(path) {
              Ok(file) => file,
              Err(ref err) if err.kind() == io::ErrorKind::InvalidData => {
                  return Err(Error::Utf8Error(Some(path.to_string())));
              }
              Err(err) => return Err(Error::IOError(path.to_string(), err)),
          };
          Ok(file.lines().map(ToString::to_string).collect())
      } else {
          Ok(vec![arg])
      }
  }
  
  pub fn arg_expand_all(at_args: &[String]) -> Vec<String> {
      let mut args = Vec::new();
      for arg in at_args {
          match arg_expand(arg.clone()) {
              Ok(arg) => args.extend(arg),
              Err(err) => rustc_session::early_error(
                  rustc_session::config::ErrorOutputType::default(),
                  &format!("Failed to load argument file: {}", err),
              ),
          }
      }
      args
  }
  rustc_driver çš„éƒ¨åˆ†ä»£ç 
  ```

  

- åŸå§‹çš„ Rust æºæ–‡æœ¬è¢«ä½äº [`rustc_lexer`](https://doc.rust-lang.org/nightly/nightly-rustc/rustc_lexer/index.html) çš„åº•å±‚è¯æ³•åˆ†æå™¨åˆ†æã€‚åœ¨è¿™ä¸ªé˜¶æ®µï¼Œæºæ–‡æœ¬è¢«è½¬åŒ–æˆè¢«ç§°ä¸º *tokens* çš„ å­æºç å•ä½åºåˆ—ã€‚ è¯æ³•åˆ†æå™¨æ”¯æŒ Unicode å­—ç¬¦ç¼–ç ( æ±‰ è¯­ ç¼– ç¨‹)ã€‚

  

- token åºåˆ—ä¼ ç»™äº†ä½äº [`rustc_parse`](https://doc.rust-lang.org/nightly/nightly-rustc/rustc_parse/index.html) çš„é«˜å±‚è¯æ³•åˆ†æå™¨ä»¥ä¸ºç¼–è¯‘æµç¨‹çš„ä¸‹ä¸€ä¸ªé˜¶æ®µåšå‡†å¤‡ã€‚ [`StringReader`](https://doc.rust-lang.org/nightly/nightly-rustc/rustc_parse/lexer/struct.StringReader.html) ç»“æ„ä½“åœ¨è¿™ä¸ªé˜¶æ®µè¢«ç”¨äºæ‰§è¡Œä¸€ç³»åˆ—çš„éªŒè¯å·¥ä½œå¹¶ä¸”å°†å­—ç¬¦ä¸²è½¬åŒ–ä¸ºé©»ç•™ç¬¦å·ï¼ˆç¨åä¾¿ä¼šè®¨è®º *é©»ç•™*ï¼‰ã€‚ [å­—ç¬¦ä¸²é©»ç•™] æ˜¯ä¸€ç§å°†å¤šä¸ªç›¸åŒçš„ä¸å¯å˜å­—ç¬¦ä¸²åªå­˜å‚¨ä¸€æ¬¡çš„æŠ€æœ¯ã€‚

- è¯æ³•åˆ†æå™¨æœ‰å°çš„æ¥å£å¹¶ä¸”ä¸ç›´æ¥ä¾èµ–äº`rustc`ä¸­çš„è¯Šæ–­åŸºç¡€è®¾æ–½ã€‚åä¹‹ï¼Œå®ƒæä¾›åœ¨`rustc_parse::lexer::mod`ä¸­è¢«å‘é€ä¸ºçœŸå®è¯Šæ–­ çš„ä½œä¸ºæ™®é€šæ•°æ®çš„è¯Šæ–­ã€‚

- è§£æå™¨ [å°†ä»è¯æ³•åˆ†æå™¨ä¸­å¾—åˆ°çš„tokenåºåˆ—è½¬åŒ–ä¸ºæŠ½è±¡è¯­æ³•æ ‘ï¼ˆASTï¼‰](https://doc.rust-lang.org/nightly/nightly-rustc/rustc_parse/index.html)ã€‚å®ƒä½¿ç”¨é€’å½’ä¸‹é™ï¼ˆè‡ªä¸Šè€Œä¸‹ï¼‰çš„æ–¹å¼æ¥è¿›è¡Œè¯­æ³•è§£æã€‚ è§£æå™¨çš„ crate å…¥ä¸º`rustc_parse::parser::item`ä¸­çš„`Parser::parse_crate_mod()`ä»¥åŠ`Parser::parse_mod()`å‡½æ•°ã€‚ å¤–éƒ¨æ¨¡å—è§£æå…¥å£ä¸º`rustc_expand::module::parse_external_mod`ã€‚ ä»¥åŠå®è§£æå…¥å£ä¸º[`Parser::parse_nonterminal()`](https://doc.rust-lang.org/nightly/nightly-rustc/rustc_parse/parser/struct.Parser.html#method.parse_nonterminal)ã€‚

- è§£æç»ç”±ä¸€ç³»åˆ— `Parser` å·¥å…·å‡½æ•°æ‰§è¡Œï¼ŒåŒ…æ‹¬`fn bump`ï¼Œ`fn check`ï¼Œ`fn eat`ï¼Œ`fn expect`ï¼Œ`fn look_ahead`ã€‚

- è§£ææ˜¯ç”±è¦è¢«è§£æçš„è¯­ä¹‰æ„é€ æ‰€ç»„ç»‡çš„ã€‚åˆ†ç¦»çš„`parse_*`æ–¹æ³•å¯ä»¥åœ¨`rustc_parse` `parser`æ–‡ä»¶å¤¹ä¸­æ‰¾åˆ°ã€‚ æºæ–‡ä»¶çš„åå­—å’Œæ„é€ åç›¸åŒã€‚

  ```rust
  pub mod attr;
  mod attr_wrapper;
  mod diagnostics;
  mod expr;
  mod generics;
  mod item;
  mod nonterminal;
  mod pat;
  mod path;
  mod stmt;
  mod ty;
  ```

  

- è¿™ç§å‘½åæ–¹æ¡ˆè¢«å¹¿æ³›åœ°åº”ç”¨äºç¼–è¯‘å™¨çš„å„ä¸ªé˜¶æ®µã€‚ä½ ä¼šå‘ç°æœ‰æ–‡ä»¶æˆ–è€…æ–‡ä»¶å¤¹åœ¨è§£æã€é™ä½ã€ç±»å‹æ£€æŸ¥ã€HIRé™ä½ã€ä»¥åŠMIRæºæ„å»ºã€‚

- å®å±•å¼€ã€ASTéªŒè¯ã€å‘½åè§£æã€ä»¥åŠç¨‹åºé”™è¯¯æ£€æŸ¥éƒ½åœ¨ç¼–è¯‘è¿‡ç¨‹çš„è¿™ä¸ªé˜¶æ®µè¿›è¡Œã€‚

- è§£æå™¨ä½¿ç”¨æ ‡å‡† `DiagnosticBuilder` API æ¥è¿›è¡Œé”™è¯¯å¤„ç†ï¼Œä½†æ˜¯æˆ‘ä»¬å¸Œæœ›åœ¨ä¸€ä¸ªé”™è¯¯å‘ç”Ÿæ—¶ï¼Œ å°è¯•æ¢å¤ã€è§£æRustè¯­æ³•çš„ä¸€ä¸ªè¶…é›†ã€‚

- `rustc_ast::ast::{Crate, Mod, Expr, Pat, ...}` ASTèŠ‚ç‚¹ä»è§£æå™¨ä¸­è¢«è¿”å›ã€‚

- æˆ‘ä»¬æ¥ä¸‹æ¥æ‹¿åˆ°ASTå¹¶ä¸”[å°†å…¶è½¬åŒ–ä¸ºé«˜çº§ä¸­é—´æ ‡è¯†ï¼ˆHIRï¼‰](https://doc.rust-lang.org/nightly/nightly-rustc/rustc_hir/index.html)ã€‚è¿™æ˜¯ä¸€ç§ç¼–è¯‘å™¨å‹å¥½çš„ AST ç¤ºæ–¹æ³•ã€‚ è¿™åŒ…æ‹¬åˆ°å¾ˆå¤šå¦‚å¾ªç¯ã€`async fn`ä¹‹ç±»çš„è§£ç³–åŒ–çš„ä¸œè¥¿ã€‚

- æˆ‘ä»¬ä½¿ç”¨ HIR æ¥è¿›è¡Œ[ç±»å‹æ¨å¯¼]ã€‚ è¿™æ˜¯å¯¹äºä¸€ä¸ªè¡¨è¾¾å¼ï¼Œè‡ªåŠ¨æ£€æµ‹å…¶ç±»å‹çš„è¿‡ç¨‹ã€‚

- HIRä¹‹å [è¢«é™ä½ä¸ºä¸­çº§ä¸­é—´æ ‡è¯†ï¼ˆMIRï¼‰](https://rustc-dev-guide.rust-lang.org/mir/index.html)ã€‚

  - åŒæ—¶ï¼Œæˆ‘ä»¬æ„é€  THIR ï¼ŒTHIRæ˜¯æ›´è§£ç³–åŒ–çš„ HIRã€‚THIRè¢«ç”¨äºæ¨¡å¼å’Œè¯¦å°½æ€§æ£€éªŒã€‚ åŒæ—¶ï¼Œå®ƒç›¸è¾ƒäº HIR æ›´å®¹æ˜“è¢«è½¬åŒ–ä¸ºMIRã€‚

- MIRè¢«ç”¨äº[å€Ÿç”¨æ£€æŸ¥]ã€‚

- [åœ¨ MIR ä¸Šåšè®¸å¤šä¼˜åŒ–](https://rustc-dev-guide.rust-lang.org/mir/optimizations.html) å®ƒä»ç„¶æ˜¯é€šç”¨çš„ï¼Œ å¹¶ä¸”è¿™æ ·èƒ½æ”¹è¿›æˆ‘ä»¬æ¥ä¸‹æ¥ç”Ÿæˆçš„ä»£ç ï¼ŒåŒæ—¶ä¹Ÿèƒ½åŠ å¿«ç¼–è¯‘é€Ÿåº¦ã€‚

  - MIR æ˜¯é«˜çº§ï¼ˆå¹¶ä¸”é€šç”¨çš„ï¼‰è¡¨ç¤ºå½¢å¼ï¼Œæ‰€ä»¥åœ¨ MIR å±‚åšä¼˜åŒ–è¦ç›¸è¾ƒäºåœ¨ LLVM-IR å±‚æ›´å®¹æ˜“ã€‚ ä¸¾ä¸ªä¾‹å­ï¼ŒLLVMçœ‹èµ·æ¥æ˜¯æ— æ³•ä¼˜åŒ– [`simplify_try`](https://github.com/rust-lang/rust/pull/66282) è¿™æ ·çš„æ¨¡å¼ï¼Œè€Œmirä¼˜åŒ–åˆ™å¯ä»¥ã€‚

- Rust ä»£ç æ˜¯ *å•æ€åŒ–*  SSA çš„ï¼Œè¿™æ„å‘³ç€å¯¹äºæ‰€æœ‰æ‰€æœ‰é€šç”¨ä»£ç è¿›è¡Œå¸¦è¢«å…·ä½“ç±»å‹æ›¿æ¢çš„ç±»å‹å‚æ•°çš„æ‹·è´ã€‚ è¦åšåˆ°è¿™ä¸€ç‚¹ï¼Œæˆ‘ä»¬è¦ç”Ÿæˆä¸€ä¸ªåˆ—è¡¨æ¥å­˜å‚¨éœ€è¦ä¸ºä»€ä¹ˆå…·ä½“ç±»å‹ç”Ÿæˆä»£ç ã€‚è¿™è¢«ç§°ä¸º *å•æ€é›†åˆ*ã€‚

-  *codegen*ã€‚

  - [ä»£ç ç”Ÿæˆï¼ˆcodegenï¼‰](https://rustc-dev-guide.rust-lang.org/backend/codegen.html)æ˜¯å°†é«˜ç­‰çº§æºè¡¨ç¤ºè½¬åŒ–ä¸ºå¯æ‰§è¡ŒäºŒè¿›åˆ¶çš„è¿‡ç¨‹ã€‚ `rustc`ä½¿ç”¨LLVMæ¥è¿›è¡Œä»£ç ç”Ÿæˆã€‚ç¬¬ä¸€æ­¥å°±æ˜¯å°† MIR è½¬åŒ–ä¸º LLVM ä¸­é—´è¡¨ç¤ºï¼ˆLLVM IRï¼‰ã€‚ è¿™æ˜¯ MIR ä¾æ®æˆ‘ä»¬ç”±ä¸Šä¸€æ­¥ç”Ÿæˆçš„åˆ—è¡¨æ¥çœŸæ­£è¢«å•æ€åŒ–çš„æ—¶å€™ã€‚
  - LLVM IR è¢«ä¼ ç»™ LLVMï¼Œå¹¶ä¸”ç”±å…¶è¿›è¡Œæ›´å¤šçš„ä¼˜åŒ–ã€‚ä¹‹åå®ƒäº§ç”Ÿæœºå™¨ç ï¼Œ è¿™åŸºæœ¬å°±æ˜¯æ·»åŠ äº†é™„åŠ åº•å±‚ç±»å‹ä»¥åŠæ³¨è§£çš„æ±‡ç¼–ä»£ç ã€‚ï¼ˆæ¯”å¦‚ä¸€ä¸ª ELF å¯¹è±¡æˆ–è€… wasmï¼‰ã€‚
  - ä¸åŒçš„åº“/äºŒè¿›åˆ¶å†…å®¹è¢«é“¾æ¥ä»¥äº§ç”Ÿæœ€ç»ˆçš„äºŒè¿›åˆ¶å†…å®¹ã€‚
  - æœ€æ–°ç‰ˆæœ¬çš„ codegen å®é™…ä¸Šæ”¯æŒå¤šç§åç«¯ ã€‚rustc_codegen_cranelift, rustc_codegen_llvm , rustc_codegen_ssaã€‚

